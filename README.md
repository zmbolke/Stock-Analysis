# Stock-Analysis

Project Overview: The purpose of this project was to write a script in VBA that efficiently analyzes the historic performance of a stock based on yearly trade volume and yearly return. The data provided includes daily volumes and stock prices for twelve separate stocks, ordered chronologically for each stock. Data was provided for 2017 and 2018 on separate tabs within an excel spreadsheet. The VBA script utilizes for loops and if then statements to sort through an array and gather the yearly return of each stock based on closing prices. The script also analyzes yearly trade volumes since more heavily traded stocks should be more easily traded. The VBA script also created a stock analysis page with headers and conditional formatting to show gains (in green) and losses (in red). The script is interactive so the user can indicate which year to analyze using a button. The analysis page can also be cleared using a button so that different years can be analyzed, one after another. The VBA script is dynamic so that additional years can be added to the spreadsheet and analyzed without changing the code (ex. Adding a new tab with data from 2019).   

Results: Overall every stock performed stronger in 2017 than 2018 with the exception of RUN and TERP. Run increased 5.5% in 2017 and 84.0% in 2018 and TERP decreased by 7.2% in 2017 and only 5.0% in 2018. All stocks had a positive return in 2017 except for TERP. The largest gain in 2017 was DQ with a 199.4% increase followed closely by SEDG at 184.5% and ENPH at 129.5%. All stocks declined in 2018 with the exception of ENPH and RUN with 81.9% and 84.0% increases respectively. Refactoring the code was helpful in shortening the run time of the script, which makes a big difference over the course of multiple iterations. The major change that I made to the script was nesting the conditional formatting inside of the initial for loop. So as the yearly change and yearly trade volumes are calculated for each stock, the conditional formatting is also applied. This decreased the run time for 2017 by roughly 45% and the runtime for 2018 by roughly 28%.   

Summary: The advantages of refactoring code are that you can substantially decrease the runtime of your code. This could result in major performance advantages when compared to competitors or previous version of your product. Additionally, making a code more efficient can save space on your computer and lead to more projects being stored and run simultaneously. One of the major disadvantages to refactoring code is the time that it takes. Once a script works, it may be very time consuming to rework the code. Additionally, refactoring code can get messy and confusing. Overall I believe it is important to refactor code because the pros far outweigh the cons.   
